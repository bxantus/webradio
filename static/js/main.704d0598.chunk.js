(this["webpackJsonpwebradio-react"]=this["webpackJsonpwebradio-react"]||[]).push([[0],{18:function(e,t,a){e.exports=a(26)},23:function(e,t,a){},26:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(14),i=a.n(s),o=(a(23),a(1)),c=a.n(o),u=a(4),l=a(2),h=a(3),d=a(5),p=a(6);var f=function(e){Object(d.a)(a,e);var t=Object(p.a)(a);function a(){return Object(l.a)(this,a),t.apply(this,arguments)}return Object(h.a)(a,[{key:"render",value:function(){var e=this,t=this.props.stations;return t?t.map((function(t){return r.a.createElement("div",{className:"clickable station",onClick:function(){var a,n;return null===(a=e.props)||void 0===a||null===(n=a.onStationSelected)||void 0===n?void 0:n.call(a,t)},key:t.id},r.a.createElement("h3",null,t.name),r.a.createElement("div",{className:"tags"},t.tags.replace(/,(?=[^\s])/g,", ")),r.a.createElement("div",{className:"flexible horizontal details"},r.a.createElement("span",{className:"country"},(a=t.country).length>0?a:"Unknown"),r.a.createElement("img",{className:"votes",src:"/webradio/icons/votes.svg"}),r.a.createElement("span",{className:"flex1"},t.votes),r.a.createElement("span",{className:"codec"},t.codec," - ",t.bitrate," kbps")),r.a.createElement("hr",null));var a})):null}}]),a}(r.a.Component),v=function(e){Object(d.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={results:void 0,searching:!1},n}return Object(h.a)(a,[{key:"componentWillMount",value:function(){var e=this,t=this.props.search;t.subscribe("searching",(function(t){e.setState({searching:t})})),t.subscribe("results",(function(t){e.setState({results:t})})),t.subscribe("query",(function(){document.scrollingElement&&(document.scrollingElement.scrollTop=0)}))}},{key:"render",value:function(){var e,t,a=this.state.results;return r.a.createElement("div",{className:"search flexible vertical "+(null!==(e=this.props.className)&&void 0!==e?e:"")},r.a.createElement("div",{className:"results"},r.a.createElement(f,{stations:a,onStationSelected:null===(t=this.props)||void 0===t?void 0:t.onStationSelected})))}}]),a}(r.a.Component),m=a(16);function b(e){return{name:e.name,id:e.stationuuid,tags:e.tags,country:e.country,language:e.language,icon:e.favicon,votes:e.votes,codec:e.codec,bitrate:e.bitrate}}var g=function(){function e(t){Object(l.a)(this,e),this.query=void 0,this.offset=0,this._hasMoreResults=!1,this.results=[],this.query=t,void 0==this.query.limit&&(this.query.limit=20)}return Object(h.a)(e,[{key:"search",value:function(){var e=Object(u.a)(c.a.mark((function e(){var t,a,n,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a="".concat(O,"/stations/search?name=").concat(this.query.name,"&order=votes&reverse=true&limit=").concat(this.query.limit,"&offset=").concat(this.offset),e.next=3,fetch(a).then((function(e){return e.json()}));case 3:n=e.sent,r=n.map(b),(t=this.results).push.apply(t,Object(m.a)(r)),this.offset=this.results.length,this._hasMoreResults=r.length==this.query.limit;case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"hasMoreResults",get:function(){return this._hasMoreResults}}]),e}();function y(e){return k.apply(this,arguments)}function k(){return(k=Object(u.a)(c.a.mark((function e(t){var a,n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a="".concat(O,"/url/").concat(t.id),e.next=3,fetch(a).then((function(e){return e.json()}));case 3:if(!(n=e.sent)||!n.url){e.next=8;break}return e.abrupt("return",n.url);case 8:return e.abrupt("return",void 0);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function w(e){return S.apply(this,arguments)}function S(){return(S=Object(u.a)(c.a.mark((function e(t){var a,n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a="".concat(O,"/stations/byuuid/").concat(t.id),e.next=3,fetch(a).then((function(e){return e.json()}));case 3:if(!(n=e.sent)||!n[0]){e.next=6;break}return e.abrupt("return",b(n[0]));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function E(e){return x.apply(this,arguments)}function x(){return(x=Object(u.a)(c.a.mark((function e(t){var a,n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a="".concat(O,"/vote/").concat(t.id),e.prev=1,e.next=4,fetch(a);case 4:if(!(n=e.sent).ok){e.next=12;break}return e.next=8,n.json();case 8:return n=e.sent,e.abrupt("return",n.ok);case 12:return e.abrupt("return",!1);case 13:e.next=18;break;case 15:return e.prev=15,e.t0=e.catch(1),e.abrupt("return",!1);case 18:case"end":return e.stop()}}),e,null,[[1,15]])})))).apply(this,arguments)}var O="https://de1.api.radio-browser.info/json";function j(e){return void 0==e.codec||void 0==e.bitrate}function N(e){return C.apply(this,arguments)}function C(){return(C=Object(u.a)(c.a.mark((function e(t){var a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w(t);case 2:if(!(a=e.sent)){e.next=7;break}return t.codec=a.codec,t.bitrate=a.bitrate,e.abrupt("return",!0);case 7:return e.abrupt("return",!1);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var T=a(7),_=a(17),P=a(15);function I(){return M.apply(this,arguments)}function M(){return(M=Object(u.a)(c.a.mark((function e(){var t,a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=localStorage.getItem("lastPlayed"))){e.next=7;break}if(!j(a=JSON.parse(t))){e.next=6;break}return e.next=6,N(a);case 6:return e.abrupt("return",a);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function F(e){localStorage.setItem("lastPlayed",JSON.stringify(e))}var R=function(){function e(){Object(l.a)(this,e),this.subs=new Map}return Object(h.a)(e,[{key:"add",value:function(e,t){var a=this.subs.get(e)||[];0==a.length&&this.subs.set(e,a);var n={onChange:t};return a.push(n),{unsubscribe:function(){var e=a.findIndex((function(e){return e==n}));e>=0&&a.splice(e)}}}},{key:"notifyFor",value:function(e,t){var a=this.subs.get(e);if(a){var n,r=Object(T.a)(a);try{for(r.s();!(n=r.n()).done;){n.value.onChange(t)}}catch(s){r.e(s)}finally{r.f()}}}}]),e}(),D=function(e){Object(d.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).name="LoadError",n}return a}(Object(_.a)(Error)),q=function(){function e(){Object(l.a)(this,e),this.player=void 0,this.station=void 0,this.statusEmitter=[],this.subs=new R,this.loading=void 0,this._volume=100}return Object(h.a)(e,[{key:"setStation",value:function(){var e=Object(u.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.player&&(this.player.off(),this.player.stop(),this.player.unload(),this.player=void 0),this.fireStatusChange("load","station"),this.station=t,this.subs.notifyFor("station",t),F(t),this.loading=this.loadPlayer(t),e.abrupt("return",this.loading);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"loadPlayer",value:function(){var e=Object(u.a)(c.a.mark((function e(t){var a,n,r,s=this;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y(t);case 2:if(n=e.sent,this.loading=void 0,n){e.next=7;break}throw this.fireStatusChange("error","cannot resolve station url"),new D("Cannot resolve station url");case 7:if((null===(a=this.station)||void 0===a?void 0:a.id)!=t.id){e.next=20;break}this.player&&(this.player.off(),this.player.unload()),this.player=new P.Howl({src:n,autoplay:!1,html5:!0,preload:!1}),this.fireStatusChange("stop"),this.player.on("load",(function(){return s.fireStatusChange("load","start playing")})),this.player.on("play",(function(){return s.fireStatusChange("play")})),this.player.on("stop",(function(){return s.fireStatusChange("stop")})),this.player.on("pause",(function(){return s.fireStatusChange("stop")})),r=function(e){return"number"==typeof e?"Error code: ".concat(e):"Details: ".concat(e)},this.player.on("loaderror",(function(e,t){return s.fireStatusChange("error","Loading the stream failed!\n"+r(t))})),this.player.on("playerror",(function(e,t){return s.fireStatusChange("error","Playback error!\n"+r(t))})),e.next=21;break;case 20:throw new D("Changed stations while loading");case 21:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"play",value:function(){var e=Object(u.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.player||!this.station){e.next=3;break}return e.next=3,this.loadPlayer(this.station);case 3:if(e.prev=3,!this.loading){e.next=7;break}return e.next=7,this.loading;case 7:e.next=16;break;case 9:if(e.prev=9,e.t0=e.catch(3),!(e.t0 instanceof D)){e.next=15;break}return e.abrupt("return");case 15:throw e.t0;case 16:this.player&&!this.player.playing()&&("unloaded"==this.player.state()&&this.fireStatusChange("load","stream"),this.player.volume(this._volume/100),this.player.play());case 17:case"end":return e.stop()}}),e,this,[[3,9]])})));return function(){return e.apply(this,arguments)}}()},{key:"stop",value:function(){this.player&&(this.player.off(),this.player.stop(),this.player.unload(),this.fireStatusChange("stop"),this.player=void 0)}},{key:"fireStatusChange",value:function(e,t){var a,n=Object(T.a)(this.statusEmitter);try{for(n.s();!(a=n.n()).done;){(0,a.value)(e,t)}}catch(r){n.e(r)}finally{n.f()}}},{key:"onStatusChanged",value:function(e){return this.statusEmitter.push(e),e}},{key:"offStatusChanged",value:function(e){var t=this.statusEmitter.findIndex((function(t){return e==t}));t>=0&&this.statusEmitter.splice(t,1)}},{key:"subscribe",value:function(e,t){return this.subs.add(e,t)}},{key:"volume",set:function(e){this._volume=e,this.player&&this.player.volume(e/100)}}]),e}(),L=new(function(){function e(){Object(l.a)(this,e),this.stations=[],this.updateCbs=[]}return Object(h.a)(e,[{key:"add",value:function(e){this.isFavorite(e)||(this.stations.push(e),this.save())}},{key:"remove",value:function(e){var t=this.stations.findIndex((function(t){return t.id==e.id}));t>=0&&(this.stations.splice(t,1),this.save())}},{key:"isFavorite",value:function(e){return void 0!=this.stations.find((function(t){return t.id==e.id}))}},{key:"save",value:function(){localStorage.setItem("stations",JSON.stringify(this.stations)),this.changed()}},{key:"load",value:function(){var e=Object(u.a)(c.a.mark((function e(){var t,a,n,r,s,i;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=localStorage.getItem("stations"))){e.next=15;break}a=JSON.parse(t),n=[],r=Object(T.a)(a);try{for(r.s();!(s=r.n()).done;)j(i=s.value)&&n.push(N(i))}catch(o){r.e(o)}finally{r.f()}if(e.prev=6,!n.length){e.next=12;break}return e.next=10,Promise.all(n);case 10:this.stations=a,this.save();case 12:return e.prev=12,this.stations!=a&&(this.stations=a,this.changed()),e.finish(12);case 15:case"end":return e.stop()}}),e,this,[[6,,12,15]])})));return function(){return e.apply(this,arguments)}}()},{key:"onUpdated",value:function(e){return this.updateCbs.push(e),e}},{key:"changed",value:function(){var e,t=Object(T.a)(this.updateCbs);try{for(t.s();!(e=t.n()).done;){(0,e.value)()}}catch(a){t.e(a)}finally{t.f()}}},{key:"list",get:function(){return this.stations}}]),e}()),U=function(e){Object(d.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,s=new Array(n),i=0;i<n;i++)s[i]=arguments[i];return(e=t.call.apply(t,[this].concat(s))).valueChangeSub=void 0,e.posStartDrag=0,e.valStart=0,e.sliderBg=r.a.createRef(),e.thumb=r.a.createRef(),e.sliderProgress=r.a.createRef(),e.dragging=!1,e.moveListener=function(t){return e.onPointerMove(t)},e.upListener=function(t){return e.onPointerUp(t)},e}return Object(h.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.valueChangeSub=this.model.subscribe("value",(function(){e.updateSliderStyles()})),this.setState({}),this.thumb.current&&this.thumb.current.setAttribute("touch-action","none")}},{key:"componentDidUpdate",value:function(){this.updateSliderStyles()}},{key:"componentWillUnmount",value:function(){this.valueChangeSub&&this.valueChangeSub.unsubscribe()}},{key:"updateSliderStyles",value:function(){if(this.sliderBg.current&&this.thumb.current){var e=this.model,t=this.sliderBg.current.clientWidth-this.thumb.current.clientWidth,a=this.thumb.current.clientWidth,n=(e.val-e.min)*t/(e.max-e.min),r=-(this.thumb.current.clientHeight-this.sliderBg.current.clientHeight)/2;this.thumb.current.setAttribute("style","left: ".concat(n,"px; top:").concat(r,"px")),this.sliderProgress.current&&this.sliderProgress.current.setAttribute("style","width: ".concat(n+a/2,"px"))}}},{key:"onPointerMove",value:function(e){if(this.dragging&&this.sliderBg.current&&this.thumb.current){var t=this.sliderBg.current.clientWidth-this.thumb.current.clientWidth,a=e.clientX-this.posStartDrag;if(t>0){var n=a*(this.model.max-this.model.min)/t;this.model.val=this.valStart+n}}}},{key:"onPointerDown",value:function(e){this.posStartDrag=e.clientX,this.valStart=this.model.val,this.dragging=!0,window.addEventListener("pointermove",this.moveListener),window.addEventListener("pointerup",this.upListener)}},{key:"onPointerUp",value:function(e){this.dragging=!1,window.removeEventListener("mousemove",this.moveListener),window.removeEventListener("mouseup",this.upListener)}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"slider bg",ref:this.sliderBg},r.a.createElement("div",{className:"slider progress",ref:this.sliderProgress}),r.a.createElement("span",{className:"thumb",ref:this.thumb,onPointerDown:function(t){return e.onPointerDown(t)}},this.props.children))}},{key:"model",get:function(){return this.props.model}}]),a}(r.a.Component),A=function(){function e(){Object(l.a)(this,e),this._min=0,this._max=100,this._val=0,this.subs=new R}return Object(h.a)(e,[{key:"setRange",value:function(e,t){if(void 0==e&&(e=this._min),void 0==t&&(t=this._max),e>=t)throw new Error("Invalid range! (min < max) should hold. Got: ".concat(e," >= ").concat(t));this._min=e,this._max=t,this._val<e?this.updateValue(e):this._val>t&&this.updateValue(t)}},{key:"subscribe",value:function(e,t){return this.subs.add(e,t)}},{key:"updateValue",value:function(e){this._val!=e&&(this._val=e,this.subs.notifyFor("value",e))}},{key:"val",get:function(){return this._val},set:function(e){e<this._min?e=this._min:e>this._max&&(e=this._max),this.updateValue(e)}},{key:"min",get:function(){return this._min}},{key:"max",get:function(){return this._max}}]),e}(),W=new q,B=function(e){Object(d.a)(a,e);var t=Object(p.a)(a);function a(){var e;Object(l.a)(this,a);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={status:"stop",voting:!1,displayError:!1},e.statusChangeId=void 0,e.volume=new A,e}return Object(h.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.statusChangeId=W.onStatusChanged((function(t,a){var n;W.station&&(null===(n=e.props.station)||void 0===n?void 0:n.id)==W.station.id&&e.setState({status:t,detail:a,displayError:"error"==t})})),this.volume.val=75,this.volume.subscribe("value",(function(e){return W.volume=e}))}},{key:"componentWillUnmount",value:function(){this.statusChangeId&&W.offStatusChanged(this.statusChangeId)}},{key:"togglePlayback",value:function(){var e=Object(u.a)(c.a.mark((function e(){var t,a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.props.station){e.next=2;break}return e.abrupt("return");case 2:if("stop"!=(t=this.getPlayStatus())&&"error"!=t){e.next=19;break}if("error"==t&&W.stop(),e.prev=5,this.setState({status:"load",detail:void 0}),(null===(a=W.station)||void 0===a?void 0:a.id)==this.props.station.id){e.next=10;break}return e.next=10,W.setStation(this.props.station);case 10:W.play(),e.next=17;break;case 13:if(e.prev=13,e.t0=e.catch(5),e.t0 instanceof D){e.next=17;break}throw e.t0;case 17:e.next=20;break;case 19:W.stop();case 20:case"end":return e.stop()}}),e,this,[[5,13]])})));return function(){return e.apply(this,arguments)}}()},{key:"getPlayStatus",value:function(){var e,t=this.state.status;return this.props.station&&this.props.station.id!=(null===(e=W.station)||void 0===e?void 0:e.id)&&(t="stop"),t}},{key:"getPlayDetail",value:function(){var e;return this.props.station&&this.props.station.id!=(null===(e=W.station)||void 0===e?void 0:e.id)?void 0:this.state.detail}},{key:"toggleFavorite",value:function(){var e=this.props.station;e&&(L.isFavorite(e)?L.remove(e):L.add(e),this.setState({}))}},{key:"vote",value:function(){var e=Object(u.a)(c.a.mark((function e(){var t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.props.station){e.next=2;break}return e.abrupt("return");case 2:return this.setState({voting:!0}),e.next=5,E(this.props.station);case 5:return e.sent,e.next=8,w(this.props.station);case 8:(t=e.sent)&&(this.props.station.votes=t.votes),this.setState({voting:!1});case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.props.station;if(!t)return null;var a=this.getPlayStatus(),n="/webradio/icons/".concat({play:"stop.svg",stop:"play.svg",load:"loading.svg",error:"play.svg"}[a]),s=this.getPlayDetail(),i=L.isFavorite(t),o=i?r.a.createElement("span",null,r.a.createElement("img",{className:"small-ico like",src:"/webradio/icons/like.svg"}),"Favorite"):void 0,c=r.a.createElement("button",{className:"play",onClick:function(t){return e.togglePlayback()}},r.a.createElement("img",{className:"play-ico ".concat(a),src:n})),u=r.a.createElement("div",{className:"error-popup flexible horizontal",onClick:function(){return e.setState({displayError:!1})}},r.a.createElement("img",{src:"/webradio/icons/info.svg"}),r.a.createElement("span",{className:"flex1"},s),r.a.createElement("img",{src:"/webradio/icons/close.svg"}));return r.a.createElement("div",{className:this.props.className+" flexible vertical player"},r.a.createElement("div",{className:"player-header flexible horizontal"},r.a.createElement("span",null,t.country),r.a.createElement("span",null,r.a.createElement("img",{className:"small-ico",src:"/webradio/icons/votes.svg"}),t.votes),o),r.a.createElement("h2",{className:"title"},t.name),r.a.createElement("p",{className:"tags"},t.tags),r.a.createElement("button",{className:"favorite-toggle",onClick:function(){return e.toggleFavorite()}},r.a.createElement("img",{className:"small-ico like",src:i?"/webradio/icons/unlike.svg":"/webradio/icons/like.svg"}),r.a.createElement("span",{className:"text"},i?"Remove Favorite":"Add as Favorite")),r.a.createElement("div",{className:"play-area  ".concat(this.state.displayError?"error":"")},this.state.displayError?u:c),r.a.createElement("div",{className:"flexible horizontal play-footer"},r.a.createElement("span",{className:"flex1"},t.codec," - ",t.bitrate," kbps"),r.a.createElement("button",{className:"vote",onClick:function(){return e.vote()},disabled:this.state.voting},r.a.createElement("img",{className:"small-ico",src:"/webradio/icons/votes.svg"}),"Vote")),r.a.createElement(U,{model:this.volume},r.a.createElement("img",{className:"volume",src:"/webradio/icons/volume.svg",draggable:"false"})))}}]),a}(r.a.Component),V=function(e){Object(d.a)(a,e);var t=Object(p.a)(a);function a(){return Object(l.a)(this,a),t.apply(this,arguments)}return Object(h.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:"about "+this.props.className},r.a.createElement("h2",null,"About webradio"),r.a.createElement("p",null,"Version: 1.0.1"),r.a.createElement("p",null,"Open source webradio implementation using React."),r.a.createElement("p",null,"Uses the api provided by ",r.a.createElement("a",{target:"blank",href:"http://www.radio-browser.info"},"www.radio-browser.info")),r.a.createElement("p",null,"If you find any issues, or have feature requests please report them at the project's github page: ",r.a.createElement("a",{href:"https://github.com/bxantus/webradio",target:"blank"},"github.com/bxantus/webradio")),r.a.createElement("a",{href:"https://bxantus.github.io/webradio/index.html"},r.a.createElement("img",{className:"qr-code",src:"/webradio/address_qr.png"})),r.a.createElement("h4",null,"Link for mobile devices:"),r.a.createElement("p",{className:"small-margin"},"Scan the code to the right on a mobile phone to open webradio on it!"))}}]),a}(r.a.Component),z=new(function(){function e(){Object(l.a)(this,e),this.subs=new R,this.searchTimer=void 0,this.currentSearch=void 0,this._searching=!1}return Object(h.a)(e,[{key:"setSearching",value:function(e){this._searching!=e&&(this.subs.notifyFor("searching",e),this._searching=e)}},{key:"scheduleSearch",value:function(){var e=Object(u.a)(c.a.mark((function e(t){var a,n=this,r=arguments;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=r.length>1&&void 0!==r[1]?r[1]:400,this.searchTimer=clearTimeout(this.searchTimer),this.searchTimer=setTimeout(Object(u.a)(c.a.mark((function e(){var a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=new g({name:t}),n.currentSearch=a,n.setSearching(!0),e.next=5,a.search();case 5:n.subs.notifyFor("query",void 0),n.setSearching(!1),n.subs.notifyFor("results",a.results);case 8:case"end":return e.stop()}}),e)}))),a);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"loadMoreResults",value:function(){var e=Object(u.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.currentSearch||!this.currentSearch.hasMoreResults){e.next=6;break}return this.setSearching(!0),e.next=4,this.currentSearch.search();case 4:this.setSearching(!1),this.subs.notifyFor("results",this.currentSearch.results);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"subscribe",value:function(e,t){return this.subs.add(e,t)}},{key:"searching",get:function(){return this._searching}},{key:"searchText",get:function(){return this.currentSearch?this.currentSearch.query.name:""}},{key:"hasMoreResults",get:function(){return!!this.currentSearch&&this.currentSearch.hasMoreResults}}]),e}()),J=function(e){Object(d.a)(a,e);var t=Object(p.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state=void 0,n.favoritesTab={title:"Favorites",content:function(e){return r.a.createElement("div",{className:e},r.a.createElement(f,{stations:L.list,onStationSelected:function(e){return n.stationSelected(e)}}))}},n.playingTab={title:"Playing",content:function(e){return r.a.createElement(B,{className:e,station:n.state.selectedStation})}},n.aboutTab={title:"About",content:function(e){return r.a.createElement(V,{className:e})}},n.tabs=[n.favoritesTab,n.playingTab,n.aboutTab],n.searchTab={title:"Search",content:function(e){return r.a.createElement(v,{className:e,search:z,onStationSelected:function(e){return n.stationSelected(e)},key:"search"},"Search content")},scrollOffset:0},n.searchInput=r.a.createRef(),n.focusOnSearch=!1,n.tabChanged=!1,L.load(),n.state={selectedTab:n.aboutTab},n}return Object(h.a)(a,[{key:"componentDidMount",value:function(){var e=Object(u.a)(c.a.mark((function e(){var t,a,n=this;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return L.onUpdated((function(){n.setState({})})),W.subscribe("station",(function(e){n.setState({}),document.title="Webradio (".concat(e.name,")")})),e.next=4,I();case 4:(t=e.sent)&&(W.setStation(t),this.stationSelected(t)),document.scrollingElement&&(a=document.scrollingElement,window.onscroll=function(e){a.scrollTop+80>a.scrollHeight-a.clientHeight&&n.state.selectedTab==n.searchTab&&z.hasMoreResults&&!z.searching&&z.loadMoreResults()});case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"changeTab",value:function(e){var t,a,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.tabChanged=this.state.selectedTab!=e,this.state.selectedTab.scrollOffset=null!==(t=null===(a=document.scrollingElement)||void 0===a?void 0:a.scrollTop)&&void 0!==t?t:0,this.setState({selectedTab:e}),n&&this.setState({selectedStation:W.station})}},{key:"stationSelected",value:function(e){this.setState({selectedStation:e}),this.changeTab(this.playingTab,!1)}},{key:"searchTextChanged",value:function(e){var t=e.target.value;z.scheduleSearch(t)}},{key:"selectSearch",value:function(){this.changeTab(this.searchTab),this.focusOnSearch=!0}},{key:"componentDidUpdate",value:function(){var e;(this.focusOnSearch&&this.searchInput.current&&(this.searchInput.current.focus(),this.focusOnSearch=!1),document.scrollingElement)&&(this.state.selectedTab==this.searchTab?document.scrollingElement.scrollTop=null!==(e=this.searchTab.scrollOffset)&&void 0!==e?e:0:this.tabChanged&&(document.scrollingElement.scrollTop=0));this.tabChanged=!1}},{key:"render",value:function(){var e,t=this,a=this.tabs,n=this.state.selectedTab,s=a.map((function(e){var a=n==e?r.a.createElement("span",{className:"selection"}):void 0;return r.a.createElement("div",{className:"tab flexible vertical",key:e.title,onClick:function(a){return t.changeTab(e)}},r.a.createElement("span",{className:"title"},e.title),a)})),i=[this.searchTab].concat(a).map((function(e){return e.content(e==n?"visible":"hidden")})),o=this.searchTab==n;return r.a.createElement("div",{className:"radio-App"},r.a.createElement("div",{id:"top",className:"flexible vertical radio"},r.a.createElement("div",{className:"header flexible horizontal"},r.a.createElement("img",{className:"logo",src:"/webradio/logo.svg"}),r.a.createElement("span",{className:"divider ".concat(o?"blinking":"static")}),r.a.createElement("span",{className:"currently-playing ".concat(o?"hidden":"visible")},null===(e=W.station)||void 0===e?void 0:e.name),r.a.createElement("input",{className:"search flex1 ".concat(o?"visible":"hidden"),ref:this.searchInput,defaultValue:z.searchText,onInput:function(e){t.searchTextChanged(e)}})),r.a.createElement("div",{className:"tabs flexible horizontal"},r.a.createElement("span",{className:"flex1"}),s,r.a.createElement("span",{className:"flex1"}),r.a.createElement("a",{className:"search-tab",onClick:function(e){return t.selectSearch()}},r.a.createElement("img",{className:"icon search",src:"/webradio/icons/search.svg"})))),r.a.createElement("div",{id:"content",className:"radio flexible vertical"},i))}}]),a}(r.a.Component),H=[];function X(e){var t=new Image;t.src=e,H.push(t)}X("/webradio/icons/loading.svg"),X("/webradio/icons/stop.svg"),i.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(J,null,"my text")),document.getElementById("root"))}},[[18,1,2]]]);
//# sourceMappingURL=main.704d0598.chunk.js.map